{"version":3,"sources":["../src/credentialstore/osx/osx-keychain.js"],"names":[],"mappings":"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","file":"osx-keychain.js","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n*  Copyright (c) Microsoft Corporation. All rights reserved.\r\n*  Licensed under the MIT License. See License.txt in the project root for license information.\r\n*--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\n\r\n//\r\n// Access to the OSX keychain - list, add, get password, remove\r\n//\r\nvar _ = require('underscore');\r\nvar childProcess = require('child_process');\r\nvar es = require('event-stream');\r\nvar parser = require('./osx-keychain-parser');\r\n\r\nvar securityPath = '/usr/bin/security';\r\n\r\nvar targetNamePrefix = '';\r\n\r\n//Allow callers to set their own prefix\r\nfunction setPrefix(prefix) {\r\n  targetNamePrefix = prefix;\r\n}\r\n\r\nfunction ensurePrefix(targetName) {\r\n  if (targetName.slice(targetNamePrefix.length) !== targetNamePrefix) {\r\n    targetName = targetNamePrefix + targetName;\r\n  }\r\n  return targetName;\r\n}\r\n\r\nfunction removePrefix(targetName) {\r\n  return targetName.slice(targetNamePrefix.length);\r\n}\r\n\r\n/**\r\n* List contents of default keychain, no passwords.\r\n*\r\n* @return {Stream} object mode stream of parsed results.\r\n*/\r\nfunction list() {\r\n  var securityProcess = childProcess.spawn(securityPath, ['dump-keychain']);\r\n\r\n  return securityProcess.stdout\r\n    .pipe(es.split())\r\n    .pipe(es.mapSync(function (line) {\r\n      return line.replace(/\\\\134/g, '\\\\');\r\n    }))\r\n    .pipe(new parser.ParsingStream());\r\n}\r\n\r\n/**\r\n* Get the password for a given key from the keychain\r\n* Assumes it's a generic credential.\r\n* \r\n* @param {string} userName user name to look up\r\n* @param {string} service service identifier\r\n* @param {Function(err, string)} callback callback receiving\r\n*                                returned result.\r\n*/\r\nfunction get(userName, service, callback) {\r\n  var args = [\r\n    'find-generic-password',\r\n    '-a', userName,\r\n    '-s', ensurePrefix(service),\r\n    '-g'\r\n  ];\r\n\r\n  childProcess.execFile(securityPath, args, function (err, stdout, stderr) {\r\n    if (err) { return callback(err); }\r\n    var match = /^password: (?:0x[0-9A-F]+  )?\"(.*)\"$/m.exec(stderr);\r\n    if (match) {\r\n      var password = match[1].replace(/\\\\134/g, '\\\\');\r\n      return callback(null, password);\r\n    }\r\n    return callback(new Error('Password in invalid format'));\r\n  });\r\n}\r\n\r\n/**\r\n* Set the password for a given key in the keychain.\r\n* Will overwrite password if the key already exists.\r\n*\r\n* @param {string} userName\r\n* @param {string} service\r\n* @param {string} description\r\n* @param {string} password\r\n* @param {function(err)} callback called on completion.\r\n*/\r\nfunction set(userName, service, description, password, callback) {\r\n  var args = [\r\n    'add-generic-password',\r\n    '-a', userName,\r\n    '-D', description,\r\n    '-s', ensurePrefix(service),\r\n    '-w', password,\r\n    '-U'\r\n  ];\r\n\r\n  childProcess.execFile(securityPath, args, function (err, stdout, stderr) {\r\n    if (err) {\r\n      return callback(new Error('Could not add password to keychain: ' + stderr));\r\n    }\r\n    return callback();\r\n  });\r\n}\r\n\r\n/**\r\n* Remove the given account from the keychain\r\n*\r\n* @param {string} userName\r\n* @param {string} service\r\n* @param {string} description\r\n* @param {function (err)} callback called on completion\r\n*/\r\nfunction remove(userName, service, description, callback) {\r\n  var args = ['delete-generic-password'];\r\n  if (userName) {\r\n    args = args.concat(['-a', userName]);\r\n  }\r\n  if (service) {\r\n    args = args.concat(['-s', ensurePrefix(service)]);\r\n  }\r\n  if (description) {\r\n    args = args.concat(['-D', description]); \r\n  }\r\n\r\n  childProcess.execFile(securityPath, args, function (err, stdout, stderr) {\r\n    if (err) {\r\n      return callback(err);\r\n    }\r\n    return callback();\r\n  });\r\n}\r\n\r\n_.extend(exports, {\r\n  list: list,\r\n  set: set,\r\n  get: get,\r\n  remove: remove,\r\n  setPrefix: setPrefix\r\n});\r\n"],"sourceRoot":"C:\\Users\\jorit\\Desktop\\vsts-vscode\\out"}